.card {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
  background-color: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: all 0.3s ease;
}

.activeCard {
  /* border-color: var(--primary); <--- Removed strong border */
  /* box-shadow: 0 0 0 2px var(--primary-foreground), 0 0 0 4px var(--primary); <--- Removed ring */

  /* Subtle shadow + scale instead */
  transform: scale(1.02);
  box-shadow: var(--shadow-lg), 0 0 0 1px var(--primary);
  /* Very subtle 1px border hint */
  z-index: 10;
  /* Pop out slightly */
}



.content {
  padding: var(--spacing-6);
}

.title {
  font-family: var(--font-family-heading);
  font-size: 1.25rem;
  font-weight: 600;
  line-height: 1.3;
  color: var(--foreground);
  margin-bottom: var(--spacing-3);
}

.preview {
  font-size: 0.9375rem;
  color: var(--muted-foreground);
  line-height: 1.6;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-4) var(--spacing-6);
  border-top: 1px solid var(--border);
  background-color: color-mix(in srgb, var(--surface), black 5%);
}

.authorInfo {
  display: flex;
  align-items: center;
  gap: var(--spacing-3);
}

.authorAvatar {
  width: 32px;
  height: 32px;
  border-width: 1px;
}

.authorName {
  font-size: 0.875rem;
  font-weight: 500;
  color: var(--foreground);
}

.date {
  font-size: 0.75rem;
  color: var(--muted-foreground);
}

.stats {
  display: flex;
  align-items: center;
  gap: var(--spacing-4);
  color: var(--muted-foreground);
}

.statItem {
  display: flex;
  align-items: center;
  gap: var(--spacing-1);
  font-size: 0.8125rem;
}

.contentBody {
  position: relative;
  transition: max-height 0.3s ease-out;
}

.contentBody p {
  margin-bottom: 1.25rem;
  line-height: 1.8;
}

.contentBody h1,
.contentBody h2,
.contentBody h3,
.contentBody h4,
.contentBody h5,
.contentBody h6 {
  margin-top: 1.5rem;
  margin-bottom: 0.75rem;
  line-height: 1.3;
}

.contentBody[data-expanded="false"] {
  max-height: 250px;
  overflow: hidden;
  mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
  -webkit-mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
}

.contentBody[data-expanded="true"] {
  /* max-height handled via inline style for animation */
  overflow: hidden;
  /* Keep hidden during transition, though visible usually implies auto. */
  /* Actually, to avoid cutting off shadows or focus rings, overflow visible might be better at the end, 
     but for height transition to work cleanly without weird clips, hidden is usually safer. 
     Let's allow it to be visible after transition if needed, but for now we rely on the height. */
}

.expandAction {
  display: flex;
  justify-content: center;
  margin-top: var(--spacing-4);
}

.expandButton {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-1);
  color: var(--muted-foreground);
  font-size: 0.9rem;
  transition: color 0.2s;
}

.expandButton:hover {
  color: var(--foreground);
  background-color: transparent !important;
}

/* Inline Comments Wrapper for Grid Animation */
.inlineCommentsWrapper {
  display: grid;
  grid-template-rows: 0fr;
  transition: grid-template-rows 0.3s ease-out;
}

.inlineCommentsWrapper[data-active="true"] {
  grid-template-rows: 1fr;
}

.inlineCommentsInner {
  overflow: hidden;
}

/* Inline Comments: Visible on all screens when active */
.inlineComments {
  display: block;
  /* Always block when rendered */
  padding: 0 var(--spacing-6) var(--spacing-6);
  /* Match card content padding */
  background-color: var(--surface);
  /* Match card background */
  /* Animation handled by wrapper now */
}

/* Remove default border/margin from internal PostComments component since we handle it here */
.inlineComments :global(.PostComments_commentsSection) {
  border-top: none;
  padding-top: 0;
  margin-top: 0;
}

.inlineCommentsDivider {
  height: 1px;
  background: var(--border);
  margin-bottom: var(--spacing-4);
  opacity: 0.5;
}



/* Image Styling within Markdown */
.imageContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: var(--spacing-6) 0;
  width: 100%;
}

.postImage {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
  /* Optional: explicit block display to prevent inline spacing issues */
  display: block;
}

.imageCaption {
  margin-top: var(--spacing-2);
  font-size: 0.875rem;
  color: var(--muted-foreground);
  text-align: center;
  font-style: italic;
}

@keyframes bounce {
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(1.4);
  }

  100% {
    transform: scale(1);
  }
}

.bounce {
  animation: bounce 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* Markdown Enhanced Styles */

/* Tables */
.contentBody table {
  width: 100%;
  border-collapse: collapse;
  margin: var(--spacing-4) 0;
  font-size: 0.9rem;
}

.contentBody th,
.contentBody td {
  border: 1px solid var(--border);
  padding: var(--spacing-2) var(--spacing-3);
  text-align: left;
}

.contentBody th {
  background-color: var(--muted);
  font-weight: 600;
}

.contentBody tr:nth-child(even) {
  background-color: color-mix(in srgb, var(--surface), black 2%);
}

/* Blockquotes */
.contentBody blockquote {
  border-left: 4px solid var(--primary);
  margin: var(--spacing-4) 0;
  padding-left: var(--spacing-4);
  color: var(--muted-foreground);
  font-style: italic;
  background-color: var(--muted);
  padding: var(--spacing-3);
  border-radius: 0 var(--radius-md) var(--radius-md) 0;
}

/* Code Blocks (handled by highlight.js mostly, but wrapper needs style) */
.contentBody pre {
  margin: var(--spacing-4) 0;
  border-radius: var(--radius-md);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
}

.contentBody code {
  font-family: var(--font-family-mono, monospace);
  font-size: 0.85rem;
}

/* Inline code (not in pre) */
.contentBody :not(pre)>code {
  background-color: var(--muted);
  padding: 0.2em 0.4em;
  border-radius: var(--radius-sm);
  color: var(--primary);
  font-size: 0.85em;
}

/* Task Lists */
.contentBody ul.contains-task-list {
  list-style-type: none !important;
  /* Force removal of bullets */
  padding-left: 0;
}

.contentBody li.task-list-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-2);
  list-style: none !important;
  /* Double ensure no bullets */
}

/* Custom Checkbox Styling */
.contentBody input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  width: 1.1em;
  height: 1.1em;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background-color: var(--surface);
  margin: 0;
  position: relative;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
  /* Prevent squishing */
}

.contentBody input[type="checkbox"]:checked {
  background-color: var(--primary);
  border-color: var(--primary);
}

.contentBody input[type="checkbox"]:checked::after {
  content: '';
  width: 4px;
  height: 8px;
  border: solid var(--primary-foreground);
  border-width: 0 2px 2px 0;
  transform: rotate(45deg) translate(0px, -1px);
}

.contentBody input[type="checkbox"]:disabled {
  cursor: default;
  opacity: 0.8;
}

/* Math */
.contentBody .katex {
  font-size: 1.1em;
}

.contentBody hr {
  margin: var(--spacing-6) 0;
  border: 0;
  border-top: 1px solid var(--border);
}

/* Links */
.contentBody a,
.contentBody a:visited {
  color: #3b82f6 !important;
  /* Explicit standard blue (Tailwind blue-500) to ensure visibility */
  text-decoration: underline !important;
  text-underline-offset: 3px;
  font-weight: 500;
}

.contentBody a:hover {
  color: #2563eb !important;
  /* Darker blue on hover */
}

/* Remove styling for links wrapping images */
.contentBody a:has(img) {
  text-decoration: none !important;
  color: inherit !important;
  border: none !important;
}

/* Remove styling for links within headers (subtitles) */
.contentBody h1 a,
.contentBody h2 a,
.contentBody h3 a,
.contentBody h4 a,
.contentBody h5 a,
.contentBody h6 a {
  text-decoration: none !important;
  color: inherit !important;
  font-weight: inherit !important;
}

.contentBody hr {
  margin: var(--spacing-6) 0;
  border: 0;
  border-top: 1px solid var(--border);
}

/* Lists */
.contentBody ul,
.contentBody ol {
  padding-left: 1.5rem;
  margin: 0.5rem 0;
}

.contentBody ul {
  list-style-type: disc;
}

.contentBody ol {
  list-style-type: decimal;
}

/* 
 * Fix for Task Lists: 
 * remark-gfm adds 'task-list-item' class to li, but sometimes structure varies.
 * We use :has() (modern) or specifics to override the default 'disc' from above.
 */
.contentBody ul:has(> li input[type="checkbox"]),
.contentBody ul.contains-task-list {
  list-style-type: none !important;
  padding-left: 0;
}

.contentBody li {
  margin: 0.25rem 0;
}

/* Task List Item specific */
.contentBody li.task-list-item,
.contentBody li:has(> input[type="checkbox"]) {
  list-style: none !important;
  display: flex;
  /* Removes display: list-item marker */
  align-items: flex-start;
  /* Align checkbox with top of text */
  gap: var(--spacing-2);
}

/* Nested lists */
.contentBody ul ul,
.contentBody ol ul,
.contentBody ul ol,
.contentBody ol ol {
  margin-top: 0.25rem;
  margin-bottom: 0.25rem;
}

/* Custom Checkbox Styling */
.contentBody input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  width: 1.25em;
  /* Slightly larger */
  height: 1.25em;
  border: 2px solid var(--border);
  /* Thicker border */
  border-radius: var(--radius-sm);
  background-color: var(--surface);
  margin-top: 0.15em;
  /* Align with text baseline visually */
  position: relative;
  cursor: pointer;
  display: grid;
  place-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.contentBody input[type="checkbox"]:checked {
  background-color: var(--primary);
  border-color: var(--primary);
}

.contentBody input[type="checkbox"]:checked::after {
  content: '';
  width: 0.4em;
  height: 0.7em;
  border: solid var(--primary-foreground);
  border-width: 0 2.5px 2.5px 0;
  /* Thicker check */
  transform: rotate(45deg) translate(0px, -1px);
}

/* Ensure disabled (read-only) checkboxes look good */
.contentBody input[type="checkbox"]:disabled {
  cursor: default;
  opacity: 1;
  /* Override default fade */
  filter: none;
}

/* Slightly dim the unchecked disabled ones if needed, but keep checked bright */
.contentBody input[type="checkbox"]:disabled:not(:checked) {
  background-color: var(--muted);
}

/* Text Formatting */
.contentBody strong {
  font-weight: 700;
  color: var(--foreground);
}

.contentBody em {
  font-style: italic;
}

.contentBody del {
  text-decoration: line-through;
  color: var(--muted-foreground);
}

.contentBody sub {
  vertical-align: sub;
  font-size: smaller;
}

.contentBody sup {
  vertical-align: super;
  font-size: smaller;
}